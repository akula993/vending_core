{% extends 'base.html' %}

{% block content %}
    <div class="container mt-4">
        <div class="row">
            <div class="col">
                <h1>{{ address.city }}, {{ address.street }} {{ address.house_number }}</h1>
                <p>Магазин: {{ address.shop_name }}</p>
            </div>
        </div>
        <a href="https://yandex.ru/maps/?pt=30.335429,59.944869&z=18&l=map">Летний сад</a>
<div id="map" style="width: 100%; height: 400px;"></div>
{{ address.geo }}
<script src="https://api-maps.yandex.ru/2.1/?lang=ru_RU" type="text/javascript"></script>
<script type="text/javascript">
ymaps.ready(init);
function init() {
	var myMap = new ymaps.Map("map", {
		center: [{{ address.geo }}],
		zoom: 18
	}, {
		searchControlProvider: 'yandex#search'
	});
    // 5. Метка с подсказкой.
	var myPlacemark = new ymaps.Placemark([{{ address.geo }}], {
		iconCaption: '{{address.shop_name}}'
	}, {
		preset: 'islands#pinkDotIcon'
	});
	myMap.geoObjects.add(myPlacemark);
}
</script>
        <div class="row mt-4">
            <div class="col">
                <h2>Список аппаратов</h2>
                <ul class="list-group">
                    {% for machine in address.machines.all %}
                        <li class="list-group-item">
                            {{ machine.name }}
                            <a href="{% url 'machine_update' machine.pk %}" class="btn btn-secondary btn-sm float-end">Редактировать</a>
                            <a href="{% url 'machine_delete' machine.pk %}"
                               class="btn btn-danger btn-sm float-end me-2">Удалить</a>
                        </li>
                    {% empty %}
                        <li class="list-group-item">Нет аппаратов</li>
                    {% endfor %}
                </ul>
            </div>
        </div>
        <div class="row mt-4">
            <div class="col">
                <a href="{% url 'machine_create' %}" class="btn btn-primary">Добавить</a>
                <a href="{% url 'address_update' address.pk %}" class="btn btn-secondary">Редактировать</a>
                <a href="{% url 'address_delete' address.pk %}" class="btn btn-danger">Удалить</a>
            </div>
        </div>
    </div>
{% endblock %}
